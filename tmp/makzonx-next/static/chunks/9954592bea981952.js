(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],31278)},55436,e=>{"use strict";let a=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],55436)},98919,e=>{"use strict";let a=(0,e.i(75254).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);e.s(["Shield",()=>a],98919)},48268,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(57688),l=e.i(59141);e.i(36180);var r=e.i(98925),i=e.i(31278);let d=(0,e.i(75254).default)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var c=e.i(69638),n=e.i(98919),u=e.i(55436),o=e.i(32341),h=e.i(33792);function m(){let{user:e}=(0,o.useAuth)(),[m,f]=(0,s.useState)([]),[x,j]=(0,s.useState)(!0),[p,y]=(0,s.useState)(null),[N,v]=(0,s.useState)(""),[b,g]=(0,s.useState)("date"),A=async()=>{j(!0);try{let e=(0,r.query)((0,r.collection)(l.db,"users"),(0,r.orderBy)("createdAt","desc")),a=await (0,r.getDocs)(e),s=[];a.forEach(e=>{s.push(e.data())}),f(s)}catch(e){console.error("Error fetching users:",e)}finally{j(!1)}};(0,s.useEffect)(()=>{A()},[]);let S=async a=>{if(a.uid===e?.uid)return void alert("You cannot ban yourself.");let s="active"===a.status?"banned":"active";if(confirm("banned"===s?`Ban ${a.displayName}?`:`Unban ${a.displayName}?`)){y(a.uid);try{await (0,r.updateDoc)((0,r.doc)(l.db,"users",a.uid),{status:s}),f(e=>e.map(e=>e.uid===a.uid?{...e,status:s}:e))}catch(e){console.error("Error updating user status:",e),alert("Failed to update user status")}finally{y(null)}}},C=async a=>{if(a.uid===e?.uid)return void alert("You cannot change your own role.");let s="user"===a.role?"admin":"user";if(confirm("admin"===s?`Make ${a.displayName} an Admin?`:`Remove Admin privileges from ${a.displayName}?`)){y(a.uid);try{await (0,r.updateDoc)((0,r.doc)(l.db,"users",a.uid),{role:s}),f(e=>e.map(e=>e.uid===a.uid?{...e,role:s}:e))}catch(e){console.error("Error updating user role:",e),alert("Failed to update user role")}finally{y(null)}}},B=m.filter(e=>{if(!N)return!0;let a=N.toLowerCase();return(e.displayName||"").toLowerCase().includes(a)||(e.email||"").toLowerCase().includes(a)}).sort((e,a)=>{if("role"===b)return"admin"===e.role&&"admin"!==a.role?-1:+("admin"!==e.role&&"admin"===a.role);if("status"===b){if("banned"===e.status&&"banned"!==a.status)return -1;if("banned"!==e.status&&"banned"===a.status)return 1}return 0});return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:h.default.pageHeader,children:[(0,a.jsx)("h1",{className:h.default.pageTitle,children:"User Management"}),(0,a.jsxs)("p",{className:h.default.pageSubtitle,children:[m.length," registered user",1!==m.length?"s":""]})]}),(0,a.jsxs)("div",{className:h.default.toolbar,children:[(0,a.jsx)("div",{className:h.default.filterPills,children:["date","role","status"].map(e=>(0,a.jsxs)("button",{onClick:()=>g(e),className:`${h.default.filterPill} ${b===e?h.default.filterPillActive:""}`,children:["Sort: ",e.charAt(0).toUpperCase()+e.slice(1)]},e))}),(0,a.jsxs)("div",{className:h.default.searchBox,children:[(0,a.jsx)(u.Search,{size:16,className:h.default.searchIcon}),(0,a.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:N,onChange:e=>v(e.target.value),className:h.default.searchInput})]})]}),x?(0,a.jsx)("div",{className:h.default.loaderWrap,children:(0,a.jsx)(i.Loader2,{className:h.default.spinner,size:36,style:{animation:"spin 1s linear infinite"}})}):(0,a.jsxs)("div",{className:h.default.card,children:[(0,a.jsx)("div",{className:h.default.tableWrap,children:(0,a.jsxs)("table",{className:h.default.table,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"User"}),(0,a.jsx)("th",{children:"Role"}),(0,a.jsx)("th",{children:"Status"}),(0,a.jsx)("th",{children:"Joined"}),(0,a.jsx)("th",{style:{textAlign:"right"},children:"Actions"})]})}),(0,a.jsx)("tbody",{children:B.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:h.default.userCell,children:[e.photoURL?(0,a.jsx)(t.default,{src:e.photoURL,alt:e.displayName,width:36,height:36,className:h.default.userAvatar}):(0,a.jsx)("div",{className:h.default.userAvatarPlaceholder,children:e.displayName?.charAt(0)||"?"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:h.default.userName,children:e.displayName}),(0,a.jsx)("div",{className:h.default.userEmail,children:e.email})]})]})}),(0,a.jsx)("td",{children:(0,a.jsxs)("span",{className:`${h.default.roleBadge} ${"admin"===e.role?h.default.roleBadgeAdmin:h.default.roleBadgeUser}`,children:["admin"===e.role&&(0,a.jsx)(n.Shield,{size:10}),e.role]})}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:`${h.default.statusBadge} ${"active"===e.status?h.default.statusActive:h.default.statusBanned}`,children:e.status})}),(0,a.jsx)("td",{children:e.createdAt?.seconds?new Date(1e3*e.createdAt.seconds).toLocaleDateString():"N/A"}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:h.default.userActionsCell,children:[(0,a.jsx)("button",{onClick:()=>C(e),disabled:p===e.uid,title:"user"===e.role?"Promote to Admin":"Demote to User",className:h.default.userActionBtn,style:"admin"===e.role?{color:"#c084fc"}:{},children:(0,a.jsx)(n.Shield,{size:16})}),(0,a.jsx)("button",{onClick:()=>S(e),disabled:p===e.uid,title:"active"===e.status?"Ban User":"Unban User",className:h.default.userActionBtn,style:"banned"===e.status?{color:"#f87171"}:{},children:"active"===e.status?(0,a.jsx)(d,{size:16}):(0,a.jsx)(c.CheckCircle,{size:16})})]})})]},e.uid))})]})}),0===B.length&&(0,a.jsx)("div",{className:h.default.emptyState,children:N?`No users match "${N}"`:"No users found."})]})]})}e.s(["default",()=>m],48268)}]);