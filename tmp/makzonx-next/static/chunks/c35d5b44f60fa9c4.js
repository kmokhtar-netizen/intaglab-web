(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let a=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],55436)},85149,e=>{"use strict";let a={cairo:"Cairo",alexandria:"Alexandria",giza:"Giza",shubra_el_kheima:"Shubra El-Kheima",port_said:"Port Said",suez:"Suez",luxor:"Luxor",mansoura:"Mansoura",el_mahalla_el_kubra:"El-Mahalla El-Kubra",tanta:"Tanta",asyut:"Asyut",ismailia:"Ismailia",fayyum:"Fayyum",zagazig:"Zagazig",aswan:"Aswan",damietta:"Damietta",damanhur:"Damanhur",minya:"Minya",beni_suef:"Beni Suef",qena:"Qena",sohag:"Sohag",hurghada:"Hurghada",sixth_of_october:"6th of October",shibin_el_kom:"Shibin El Kom",banha:"Banha",kafr_el_sheikh:"Kafr El-Sheikh",arish:"Arish",mallawi:"Mallawi",tenth_of_ramadan:"10th of Ramadan",bilbais:"Bilbais",marsa_matruh:"Marsa Matruh",idfu:"Idfu",mit_ghamr:"Mit Ghamr",al_hamidiyya:"Al-Hamidiyya",desouk:"Desouk",qalyub:"Qalyub",abu_kabir:"Abu Kabir",kafr_el_dawar:"Kafr El-Dawar",girga:"Girga",akhmim:"Akhmim",matareya:"Matareya"},t={textiles_garments:"Textiles & Garments",food_beverage:"Food & Beverage",construction_building:"Construction & Building Materials",chemicals_petrochemicals:"Chemicals & Petrochemicals",pharmaceuticals_medical:"Pharmaceuticals & Medical",metal_steel:"Metal & Steel",plastic_rubber:"Plastics & Rubber",engineering_manufacturing:"Engineering & Manufacturing",automotive_transportation:"Automotive & Transportation",electronics_appliances:"Electronics & Appliances",energy_renewable:"Energy & Renewable Power",paper_packaging:"Paper & Packaging",furniture_wood:"Furniture & Woodworking",mining_quarrying:"Mining & Quarrying",agriculture_farming:"Agriculture & Farming",other:"Other"},s={cnc_machining:"CNC Machining",injection_molding:"Injection Molding",printing_3d:"3D Printing",sheet_metal:"Sheet Metal Fabrication",casting:"Casting",forging:"Forging",welding:"Welding",assembly:"Assembly",quality_control:"Quality Control / Inspection",finishing:"Finishing / Surface Treatment",engineering_design:"Engineering & Design",other:"Other"};Object.values(a).sort(),Object.values(t).sort(),Object.values(s).sort(),Object.values({aluminum:"Aluminum",steel:"Steel",stainless_steel:"Stainless Steel",brass:"Brass",copper:"Copper",titanium:"Titanium",abs_plastic:"ABS Plastic",polycarbonate:"Polycarbonate",nylon:"Nylon",rubber:"Rubber",wood:"Wood",glass:"Glass",composites:"Composites"}).sort(),e.s(["CATEGORIES",0,t,"CATEGORY_IMAGES",0,{textiles_garments:"https://images.unsplash.com/photo-1534639074092-aa2c0ec224f3?auto=format&fit=crop&w=800&q=80",food_beverage:"https://images.unsplash.com/photo-1596459349887-8bc8592f801a?auto=format&fit=crop&w=800&q=80",construction_building:"https://images.unsplash.com/photo-1541888946425-d81bb19240f5?auto=format&fit=crop&w=800&q=80",chemicals_petrochemicals:"https://images.unsplash.com/photo-1563823293817-497b77ab4376?auto=format&fit=crop&w=800&q=80",pharmaceuticals_medical:"https://images.unsplash.com/photo-1581093458791-9f3c3900df4b?auto=format&fit=crop&w=800&q=80",metal_steel:"https://images.unsplash.com/photo-1504381384074-9b2f60a92986?auto=format&fit=crop&w=800&q=80",plastic_rubber:"https://images.unsplash.com/photo-1516937941344-00b4e0337589?auto=format&fit=crop&w=800&q=80",engineering_manufacturing:"https://images.unsplash.com/photo-1565043589221-1a6fd9ae45c7?auto=format&fit=crop&w=800&q=80",automotive_transportation:"https://images.unsplash.com/photo-1503376763036-066120622c74?auto=format&fit=crop&w=800&q=80",electronics_appliances:"https://images.unsplash.com/photo-1550751827-4bd374c3f58b?auto=format&fit=crop&w=800&q=80",energy_renewable:"https://images.unsplash.com/photo-1473341304170-971dccb5ac1e?auto=format&fit=crop&w=800&q=80",paper_packaging:"https://images.unsplash.com/photo-1605663864774-748f5f858a08?auto=format&fit=crop&w=800&q=80",furniture_wood:"https://images.unsplash.com/photo-1611082348555-467406a4897c?auto=format&fit=crop&w=800&q=80",mining_quarrying:"https://images.unsplash.com/photo-1524514652237-773a76e0be0d?auto=format&fit=crop&w=800&q=80",agriculture_farming:"https://images.unsplash.com/photo-1625246333195-09d9b11d7013?auto=format&fit=crop&w=800&q=80",other:"https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?auto=format&fit=crop&w=800&q=80"},"CITIES",0,a,"MANUFACTURING_SERVICES",0,s])},31278,e=>{"use strict";let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],31278)},43531,e=>{"use strict";let a=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>a],43531)},69505,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(59141);e.i(36180);var l=e.i(98925),i=e.i(31278),n=e.i(43531),r=e.i(37727),o=e.i(75254);let d=(0,o.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var c=e.i(55436);let u=(0,o.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),p=(0,o.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var m=e.i(22016),h=e.i(32341),f=e.i(85149),g=e.i(33792);function b(){let{user:e}=(0,h.useAuth)(),[o,b]=(0,t.useState)([]),[j,x]=(0,t.useState)(!0),[y,v]=(0,t.useState)("pending"),[N,_]=(0,t.useState)(null),[w,k]=(0,t.useState)(""),[A,S]=(0,t.useState)(new Set),[C,D]=(0,t.useState)(!1),[I,$]=(0,t.useState)(null),[M,B]=(0,t.useState)(null),[E,T]=(0,t.useState)("incomplete_details"),[z,q]=(0,t.useState)(""),L=async()=>{x(!0),S(new Set);try{let e=(0,l.query)((0,l.collection)(s.db,"products"),(0,l.where)("status","==",y),(0,l.orderBy)("createdAt","desc")),a=await (0,l.getDocs)(e),t=[];a.forEach(e=>{t.push({id:e.id,...e.data()})}),b(t)}catch(e){console.error("Error fetching posts:",e)}finally{x(!1)}};(0,t.useEffect)(()=>{L()},[y]);let P=async(a,t,i)=>{_(a.id);try{let n={status:t,reviewedBy:e?.uid,reviewedAt:(0,l.serverTimestamp)()};i&&"rejected"===t&&(n.rejectionReason=i),await (0,l.updateDoc)((0,l.doc)(s.db,"products",a.id),n);let r="approved"===t?"notifications.types.post_approved":"notifications.types.post_rejected",o="approved"===t?`Your listing '${a.description_en||a.description}' has been approved and is now live.`:`Your listing '${a.description_en||a.description}' was not approved. Reason: ${i}`,d=a.userId||a.sellerId||"unknown";if("unknown"!==d){await (0,l.addDoc)((0,l.collection)(s.db,"notifications"),{userId:d,type:"approved"===t?"post_approved":"post_rejected",title:r,message:o,read:!1,createdAt:(0,l.serverTimestamp)(),link:"/admin/posts"});let e=a.userEmail||a.contactEmail;e&&await (0,l.addDoc)((0,l.collection)(s.db,"mail"),{to:e,message:{subject:"approved"===t?"Listing Approved - Intaglab":"Listing Needs Attention - Intaglab",html:`
                                <h2>Listing ${"approved"===t?"Approved":"Needs Attention"}</h2>
                                <p>Hello,</p>
                                <p>${o}</p>
                                <br/>
                                <p>Thank you,</p>
                                <p>Intaglab Team</p>
                            `}})}b(e=>e.filter(e=>e.id!==a.id)),S(e=>{let t=new Set(e);return t.delete(a.id),t}),B(null)}catch(e){console.error("Error updating status:",e),alert("Failed to update status")}finally{_(null)}},R=async e=>{if(confirm("Permanently delete this post? This cannot be undone.")){_(e);try{await (0,l.deleteDoc)((0,l.doc)(s.db,"products",e)),b(a=>a.filter(a=>a.id!==e))}catch(e){console.error("Error deleting:",e),alert("Failed to delete post")}finally{_(null)}}},G=async a=>{if(0===A.size)return;let t="approved"===a?"approve":"reject";if(confirm(`${t.charAt(0).toUpperCase()+t.slice(1)} ${A.size} post(s)?`)){D(!0);try{await Promise.all(Array.from(A).map(t=>(0,l.updateDoc)((0,l.doc)(s.db,"products",t),{status:a,reviewedBy:e?.uid,reviewedAt:(0,l.serverTimestamp)()}))),b(e=>e.filter(e=>!A.has(e.id))),S(new Set)}catch(e){console.error("Bulk action error:",e),alert("Some updates failed")}finally{D(!1)}}},O=o.filter(e=>{if(!w)return!0;let a=w.toLowerCase();return(e.description_en||e.description||"").toLowerCase().includes(a)||(e.category||"").toLowerCase().includes(a)||(e.listingType||"").toLowerCase().includes(a)}),V=e=>e?f.CATEGORIES[e]||e:"—",F=e=>e?f.CITIES[e]||e:"—";return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:g.default.pageHeader,children:[(0,a.jsx)("h1",{className:g.default.pageTitle,children:"Post Moderation"}),(0,a.jsx)("p",{className:g.default.pageSubtitle,children:"Review, approve, and manage product listings"})]}),(0,a.jsxs)("div",{className:g.default.toolbar,children:[(0,a.jsx)("div",{className:g.default.filterPills,children:["pending","approved","rejected"].map(e=>(0,a.jsx)("button",{onClick:()=>v(e),className:`${g.default.filterPill} ${y===e?g.default.filterPillActive:""}`,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,a.jsxs)("div",{className:g.default.searchBox,children:[(0,a.jsx)(c.Search,{size:16,className:g.default.searchIcon}),(0,a.jsx)("input",{type:"text",placeholder:"Search posts...",value:w,onChange:e=>k(e.target.value),className:g.default.searchInput})]}),"pending"===y&&A.size>0&&(0,a.jsx)("div",{className:g.default.toolbarActions,children:(0,a.jsxs)("button",{onClick:()=>G("approved"),disabled:C,className:`${g.default.bulkBtn} ${g.default.bulkBtnApprove}`,children:[(0,a.jsx)(n.Check,{size:14}),"Approve (",A.size,")"]})})]}),"pending"===y&&O.length>0&&(0,a.jsxs)("div",{style:{marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("input",{type:"checkbox",checked:A.size===O.length&&O.length>0,onChange:()=>{A.size===O.length?S(new Set):S(new Set(O.map(e=>e.id)))},style:{accentColor:"#8b5cf6"}}),(0,a.jsxs)("span",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.4)"},children:["Select all (",O.length,")"]})]}),j?(0,a.jsx)("div",{className:g.default.loaderWrap,children:(0,a.jsx)(i.Loader2,{className:g.default.spinner,size:36,style:{animation:"spin 1s linear infinite"}})}):0===O.length?(0,a.jsx)("div",{className:g.default.card,children:(0,a.jsx)("div",{className:g.default.emptyState,children:w?`No results for "${w}"`:`No ${y} posts found.`})}):(0,a.jsx)("div",{className:g.default.postsList,children:O.map(e=>(0,a.jsxs)("div",{className:`${g.default.postCard} ${A.has(e.id)?g.default.postCardSelected:""}`,children:["pending"===y&&(0,a.jsx)("div",{className:g.default.postCheckbox,children:(0,a.jsx)("input",{type:"checkbox",checked:A.has(e.id),onChange:()=>{var a;return a=e.id,void S(e=>{let t=new Set(e);return t.has(a)?t.delete(a):t.add(a),t})}})}),(0,a.jsx)("div",{className:g.default.postImageWrap,onClick:()=>$(e),children:(0,a.jsx)("img",{src:e.images?.length>0?e.images[0]:f.CATEGORY_IMAGES[e.category||"other"]||f.CATEGORY_IMAGES.other,alt:"",className:g.default.postImage})}),(0,a.jsxs)("div",{className:g.default.postBody,children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:g.default.postTopRow,children:[(0,a.jsx)("span",{className:g.default.postBadge,children:e.listingType}),(0,a.jsx)("span",{className:g.default.postDate,children:e.createdAt?.seconds?new Date(1e3*e.createdAt.seconds).toLocaleDateString():"Just now"})]}),(0,a.jsx)("h3",{className:g.default.postTitle,children:e.description_en||e.description}),(0,a.jsxs)("p",{className:g.default.postMeta,children:[V(e.category)," · ",e.price," ",e.currency," · ",F(e.location)]})]}),(0,a.jsxs)("div",{className:g.default.postActions,children:[(0,a.jsxs)("button",{className:`${g.default.postActionBtn} ${g.default.btnPreview}`,onClick:()=>$(e),children:[(0,a.jsx)(p,{size:14}),"Details"]}),(0,a.jsxs)(m.default,{href:`/products/${e.id}`,target:"_blank",className:`${g.default.postActionBtn} ${g.default.btnPreview}`,children:[(0,a.jsx)(d,{size:14}),"Preview"]}),(0,a.jsx)("div",{className:g.default.postActionSpacer}),"pending"===y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>B(e),disabled:N===e.id,className:`${g.default.postActionBtn} ${g.default.btnReject}`,children:[(0,a.jsx)(r.X,{size:14}),"Reject"]}),(0,a.jsxs)("button",{onClick:()=>P(e,"approved"),disabled:N===e.id,className:`${g.default.postActionBtn} ${g.default.btnApprove}`,children:[N===e.id?(0,a.jsx)(i.Loader2,{size:14,style:{animation:"spin 1s linear infinite"}}):(0,a.jsx)(n.Check,{size:14}),"Approve"]})]}),"rejected"===y&&(0,a.jsx)("button",{onClick:()=>P(e,"pending"),disabled:N===e.id,className:`${g.default.postActionBtn} ${g.default.btnReevaluate}`,children:"Re-evaluate"}),"approved"===y&&(0,a.jsx)("button",{onClick:()=>P(e,"pending"),disabled:N===e.id,className:`${g.default.postActionBtn} ${g.default.btnReevaluate}`,children:"Suspend"}),(0,a.jsx)("button",{onClick:()=>R(e.id),disabled:N===e.id,className:`${g.default.postActionBtn} ${g.default.btnDelete}`,title:"Delete permanently",children:(0,a.jsx)(u,{size:14})})]})]})]},e.id))}),I&&(0,a.jsx)("div",{className:g.default.modalOverlay,onClick:()=>$(null),children:(0,a.jsxs)("div",{className:g.default.modalContent,onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{className:g.default.modalClose,onClick:()=>$(null),children:(0,a.jsx)(r.X,{size:20})}),I.images?.length>0&&(0,a.jsx)("div",{className:g.default.modalGallery,children:I.images.map((e,t)=>(0,a.jsx)("img",{src:e,alt:"",className:g.default.modalGalleryImage},t))}),(0,a.jsxs)("div",{className:g.default.modalBody,children:[(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",flexWrap:"wrap"},children:[(0,a.jsx)("span",{className:g.default.postBadge,children:I.listingType}),(0,a.jsx)("span",{className:`${g.default.statusBadge} ${"approved"===I.status?g.default.statusActive:"rejected"===I.status?g.default.statusBanned:""}`,style:"pending"===I.status?{background:"rgba(234,179,8,0.15)",color:"#facc15"}:{},children:I.status})]}),(0,a.jsx)("h2",{className:g.default.modalTitle,children:I.description_en||I.description}),I.description_ar&&(0,a.jsx)("p",{style:{fontSize:"0.85rem",color:"rgba(255,255,255,0.4)",direction:"rtl",marginBottom:"0.5rem"},children:I.description_ar}),(0,a.jsxs)("div",{className:g.default.modalDetailGrid,children:[(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Category"}),(0,a.jsx)("span",{className:g.default.modalDetailValue,children:V(I.category)})]}),(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Price"}),(0,a.jsxs)("span",{className:g.default.modalDetailValue,children:[I.price," ",I.currency]})]}),(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Location"}),(0,a.jsx)("span",{className:g.default.modalDetailValue,children:F(I.location)})]}),(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Condition"}),(0,a.jsx)("span",{className:g.default.modalDetailValue,children:I.condition||"—"})]}),I.quantity&&(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Quantity"}),(0,a.jsxs)("span",{className:g.default.modalDetailValue,children:[I.quantity," ",I.unitMetric]})]}),I.mfgDate&&(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Mfg Date"}),(0,a.jsx)("span",{className:g.default.modalDetailValue,children:I.mfgDate})]}),(I.warranty_en||I.warranty)&&(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Warranty"}),(0,a.jsx)("span",{className:g.default.modalDetailValue,children:I.warranty_en||I.warranty})]}),(I.delivery_en||I.delivery)&&(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Delivery"}),(0,a.jsx)("span",{className:g.default.modalDetailValue,children:I.delivery_en||I.delivery})]}),(I.terms_en||I.terms)&&(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Terms"}),(0,a.jsx)("span",{className:g.default.modalDetailValue,children:I.terms_en||I.terms})]}),(0,a.jsxs)("div",{className:g.default.modalDetailItem,children:[(0,a.jsx)("span",{className:g.default.modalDetailLabel,children:"Posted"}),(0,a.jsx)("span",{className:g.default.modalDetailValue,children:I.createdAt?.seconds?new Date(1e3*I.createdAt.seconds).toLocaleString():"Just now"})]})]})]}),"pending"===I.status&&(0,a.jsxs)("div",{className:g.default.modalFooter,children:[(0,a.jsxs)("button",{onClick:()=>{B(I),$(null)},className:`${g.default.postActionBtn} ${g.default.btnReject}`,children:[(0,a.jsx)(r.X,{size:14})," Reject"]}),(0,a.jsxs)("button",{onClick:()=>{P(I,"approved"),$(null)},className:`${g.default.postActionBtn} ${g.default.btnApprove}`,children:[(0,a.jsx)(n.Check,{size:14})," Approve"]})]})]})})]})}e.s(["default",()=>b],69505)}]);