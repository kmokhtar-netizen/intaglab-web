(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";let a=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>a],71689)},63940,e=>{e.v({backBtn:"page-module__VBdWPW__backBtn",container:"page-module__VBdWPW__container",content:"page-module__VBdWPW__content",emptyState:"page-module__VBdWPW__emptyState",formGrid:"page-module__VBdWPW__formGrid",formGroup:"page-module__VBdWPW__formGroup",formGroupFull:"page-module__VBdWPW__formGroupFull",header:"page-module__VBdWPW__header",messageItem:"page-module__VBdWPW__messageItem",messageUnread:"page-module__VBdWPW__messageUnread",messagesList:"page-module__VBdWPW__messagesList",msgDate:"page-module__VBdWPW__msgDate",msgDetailBody:"page-module__VBdWPW__msgDetailBody",msgDetailHeader:"page-module__VBdWPW__msgDetailHeader",msgDetailMeta:"page-module__VBdWPW__msgDetailMeta",msgDetailSubject:"page-module__VBdWPW__msgDetailSubject",msgExcerpt:"page-module__VBdWPW__msgExcerpt",msgHeader:"page-module__VBdWPW__msgHeader",msgSender:"page-module__VBdWPW__msgSender",msgSubject:"page-module__VBdWPW__msgSubject",panel:"page-module__VBdWPW__panel",saveBtn:"page-module__VBdWPW__saveBtn",sidebar:"page-module__VBdWPW__sidebar",subtitle:"page-module__VBdWPW__subtitle",successMsg:"page-module__VBdWPW__successMsg",tabActive:"page-module__VBdWPW__tabActive",tabBtn:"page-module__VBdWPW__tabBtn",tabIcon:"page-module__VBdWPW__tabIcon",title:"page-module__VBdWPW__title"})},13278,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(32341),l=e.i(18566),d=e.i(46932),i=e.i(88653),r=e.i(84614),n=e.i(86311),o=e.i(75254);let m=(0,o.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var c=e.i(71689);let u=(0,o.default)("mail-x",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h9",key:"1j9vog"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m17 17 4 4",key:"1b3523"}],["path",{d:"m21 17-4 4",key:"uinynz"}]]);e.i(36180);var p=e.i(98925),g=e.i(59141),_=e.i(63940),h=e.i(94913);function f(){let{user:e,userData:o,loading:f}=(0,t.useAuth)(),x=(0,l.useRouter)(),[y,j]=(0,s.useState)("details"),[v,b]=(0,s.useState)(!1),[W,N]=(0,s.useState)(!1),[B,P]=(0,s.useState)({displayName:"",companyName:"",industry:"",phone:"",needs:""}),[S,V]=(0,s.useState)([]),[D,k]=(0,s.useState)(null);(0,s.useEffect)(()=>{f||e||x.push("/")},[e,f,x]),(0,s.useEffect)(()=>{o&&P({displayName:o.displayName||"",companyName:o.companyName||"",industry:o.industry||"",phone:o.phone||"",needs:o.needs||""})},[o]),(0,s.useEffect)(()=>{if(!e?.uid)return;let a=(0,p.query)((0,p.collection)(g.db,"messages"),(0,p.where)("recipientId","==",e.uid)),s=(0,p.onSnapshot)(a,e=>{let a=e.docs.map(e=>({id:e.id,...e.data()}));a.sort((e,a)=>{let s=e.createdAt?.toMillis()||0;return(a.createdAt?.toMillis()||0)-s}),V(a)});return()=>s()},[e]);let A=async a=>{if(a.preventDefault(),e){b(!0),N(!1);try{let a=(0,p.doc)(g.db,"users",e.uid);await (0,p.updateDoc)(a,{displayName:B.displayName,companyName:B.companyName,industry:B.industry,phone:B.phone,needs:B.needs}),N(!0),setTimeout(()=>N(!1),3e3)}catch(e){console.error("Error updating profile",e)}finally{b(!1)}}},M=async a=>{if(k(a),!a.read&&e)try{await (0,p.updateDoc)((0,p.doc)(g.db,"messages",a.id),{read:!0})}catch(e){console.error("Failed to mark message as read",e)}};if(f||!e)return(0,a.jsx)("div",{className:_.default.container,children:"Loading..."});let G=o?.accountType==="company";return(0,a.jsxs)("div",{className:_.default.container,children:[(0,a.jsxs)("div",{className:_.default.header,children:[(0,a.jsx)("h1",{className:_.default.title,children:"Your Profile"}),(0,a.jsx)("p",{className:_.default.subtitle,children:"Manage your settings, inventory needs, and messages."})]}),(0,a.jsxs)("div",{className:_.default.content,children:[(0,a.jsxs)("div",{className:_.default.sidebar,children:[(0,a.jsxs)("button",{className:`${_.default.tabBtn} ${"details"===y?_.default.tabActive:""}`,onClick:()=>{j("details"),k(null)},children:[(0,a.jsx)(r.User,{size:18,className:_.default.tabIcon}),"Profile Details"]}),(0,a.jsxs)("button",{className:`${_.default.tabBtn} ${"messages"===y?_.default.tabActive:""}`,onClick:()=>{j("messages"),k(null)},children:[(0,a.jsx)(n.MessageSquare,{size:18,className:_.default.tabIcon}),"Messages",S.filter(e=>!e.read).length>0&&(0,a.jsx)("span",{style:{background:"#ef4444",color:"white",padding:"2px 8px",borderRadius:"12px",fontSize:"0.75rem",marginLeft:"auto"},children:S.filter(e=>!e.read).length})]})]}),(0,a.jsx)("div",{className:_.default.panel,children:(0,a.jsxs)(i.AnimatePresence,{mode:"wait",children:["details"===y&&(0,a.jsx)(d.motion.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:(0,a.jsxs)("form",{onSubmit:A,children:[(0,a.jsx)("h3",{style:{marginBottom:"1.5rem",fontSize:"1.25rem"},children:"Personal Information"}),(0,a.jsxs)("div",{className:_.default.formGrid,children:[(0,a.jsxs)("div",{className:_.default.formGroup,children:[(0,a.jsx)("label",{children:"Email Address"}),(0,a.jsx)("input",{type:"email",value:e.email||"",readOnly:!0})]}),(0,a.jsxs)("div",{className:_.default.formGroup,children:[(0,a.jsx)("label",{children:"Display Name"}),(0,a.jsx)("input",{type:"text",value:B.displayName,onChange:e=>P({...B,displayName:e.target.value})})]}),(0,a.jsxs)("div",{className:_.default.formGroup,children:[(0,a.jsx)("label",{children:"Phone Number"}),(0,a.jsx)("input",{type:"tel",value:B.phone,onChange:e=>P({...B,phone:e.target.value})})]}),G&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:_.default.formGroup,children:[(0,a.jsx)("label",{children:"Company Name"}),(0,a.jsx)("input",{type:"text",value:B.companyName,onChange:e=>P({...B,companyName:e.target.value})})]}),(0,a.jsxs)("div",{className:_.default.formGroup,children:[(0,a.jsx)("label",{children:"Industry"}),(0,a.jsx)("input",{type:"text",value:B.industry,onChange:e=>P({...B,industry:e.target.value})})]})]}),(0,a.jsxs)("div",{className:`${_.default.formGroup} ${_.default.formGroupFull}`,children:[(0,a.jsx)("label",{children:"Inventory Needs / Looking For"}),(0,a.jsx)("p",{style:{fontSize:"0.85rem",color:"rgba(255,255,255,0.5)",marginBottom:"0.5rem",marginTop:"-0.25rem"},children:"Describe the type of surplus machinery, materials, or equipment you are actively seeking."}),(0,a.jsx)("textarea",{placeholder:"e.g. We are looking for gently used packaging machinery (shrink wrappers, carton sealers) and surplus steel piping...",value:B.needs,onChange:e=>P({...B,needs:e.target.value})})]})]}),(0,a.jsxs)("div",{style:{clear:"both",overflow:"hidden"},children:[(0,a.jsx)("button",{type:"submit",className:_.default.saveBtn,disabled:v,children:v?"Saving...":"Save Changes"}),W&&(0,a.jsxs)("span",{className:_.default.successMsg,children:[(0,a.jsx)(m,{size:16})," Saved Successfully!"]})]})]})},"details"),"messages"===y&&!D&&(0,a.jsxs)(d.motion.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:[(0,a.jsx)("h3",{style:{marginBottom:"1.5rem",fontSize:"1.25rem"},children:"Your Inbox"}),0===S.length?(0,a.jsxs)("div",{className:_.default.emptyState,children:[(0,a.jsx)(u,{size:48,opacity:.5,style:{margin:"0 auto",marginBottom:"1rem"}}),(0,a.jsx)("p",{children:"You have no messages yet."})]}):(0,a.jsx)("div",{className:_.default.messagesList,children:S.map(e=>(0,a.jsxs)("div",{className:`${_.default.messageItem} ${!e.read?_.default.messageUnread:""}`,onClick:()=>M(e),children:[(0,a.jsxs)("div",{className:_.default.msgHeader,children:[(0,a.jsx)("span",{className:_.default.msgSender,children:e.senderName}),(0,a.jsx)("span",{className:_.default.msgDate,children:e.createdAt?(0,h.formatDistanceToNow)(e.createdAt.toDate(),{addSuffix:!0}):""})]}),(0,a.jsx)("div",{className:_.default.msgSubject,children:e.subject}),(0,a.jsx)("div",{className:_.default.msgExcerpt,children:e.body})]},e.id))})]},"messagesList"),"messages"===y&&D&&(0,a.jsxs)(d.motion.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:[(0,a.jsxs)("button",{className:_.default.backBtn,onClick:()=>k(null),children:[(0,a.jsx)(c.ArrowLeft,{size:16})," Back to Inbox"]}),(0,a.jsxs)("div",{className:_.default.msgDetailHeader,children:[(0,a.jsx)("h2",{className:_.default.msgDetailSubject,children:D.subject}),(0,a.jsxs)("div",{className:_.default.msgDetailMeta,children:[(0,a.jsxs)("span",{children:["From: ",(0,a.jsx)("strong",{style:{color:"white"},children:D.senderName})]}),(0,a.jsx)("span",{children:D.createdAt?new Date(D.createdAt.toDate()).toLocaleString():""})]})]}),(0,a.jsx)("div",{className:_.default.msgDetailBody,children:D.body})]},"messageDetail")]})})]})]})}e.s(["default",()=>f],13278)}]);