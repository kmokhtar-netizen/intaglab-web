module.exports=[210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},67389,a=>{a.v({backBtn:"page-module__VBdWPW__backBtn",container:"page-module__VBdWPW__container",content:"page-module__VBdWPW__content",emptyState:"page-module__VBdWPW__emptyState",formGrid:"page-module__VBdWPW__formGrid",formGroup:"page-module__VBdWPW__formGroup",formGroupFull:"page-module__VBdWPW__formGroupFull",header:"page-module__VBdWPW__header",messageItem:"page-module__VBdWPW__messageItem",messageUnread:"page-module__VBdWPW__messageUnread",messagesList:"page-module__VBdWPW__messagesList",msgDate:"page-module__VBdWPW__msgDate",msgDetailBody:"page-module__VBdWPW__msgDetailBody",msgDetailHeader:"page-module__VBdWPW__msgDetailHeader",msgDetailMeta:"page-module__VBdWPW__msgDetailMeta",msgDetailSubject:"page-module__VBdWPW__msgDetailSubject",msgExcerpt:"page-module__VBdWPW__msgExcerpt",msgHeader:"page-module__VBdWPW__msgHeader",msgSender:"page-module__VBdWPW__msgSender",msgSubject:"page-module__VBdWPW__msgSubject",panel:"page-module__VBdWPW__panel",saveBtn:"page-module__VBdWPW__saveBtn",sidebar:"page-module__VBdWPW__sidebar",subtitle:"page-module__VBdWPW__subtitle",successMsg:"page-module__VBdWPW__successMsg",tabActive:"page-module__VBdWPW__tabActive",tabBtn:"page-module__VBdWPW__tabBtn",tabIcon:"page-module__VBdWPW__tabIcon",title:"page-module__VBdWPW__title"})},70298,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56025),e=a.i(50944),f=a.i(46271),g=a.i(62036),h=a.i(46842),i=a.i(63588),j=a.i(70106);let k=(0,j.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var l=a.i(210);let m=(0,j.default)("mail-x",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h9",key:"1j9vog"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m17 17 4 4",key:"1b3523"}],["path",{d:"m21 17-4 4",key:"uinynz"}]]);a.i(69387);var n=a.i(60574),o=a.i(20237),p=a.i(67389),q=a.i(94632);function r(){let{user:a,userData:j,loading:r}=(0,d.useAuth)(),s=(0,e.useRouter)(),[t,u]=(0,c.useState)("details"),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)({displayName:"",companyName:"",industry:"",phone:"",needs:""}),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(null);(0,c.useEffect)(()=>{r||a||s.push("/")},[a,r,s]),(0,c.useEffect)(()=>{j&&A({displayName:j.displayName||"",companyName:j.companyName||"",industry:j.industry||"",phone:j.phone||"",needs:j.needs||""})},[j]),(0,c.useEffect)(()=>{if(!a?.uid)return;let b=(0,n.query)((0,n.collection)(o.db,"messages"),(0,n.where)("recipientId","==",a.uid)),c=(0,n.onSnapshot)(b,a=>{let b=a.docs.map(a=>({id:a.id,...a.data()}));b.sort((a,b)=>{let c=a.createdAt?.toMillis()||0;return(b.createdAt?.toMillis()||0)-c}),C(b)});return()=>c()},[a]);let F=async b=>{if(b.preventDefault(),a){w(!0),y(!1);try{let b=(0,n.doc)(o.db,"users",a.uid);await (0,n.updateDoc)(b,{displayName:z.displayName,companyName:z.companyName,industry:z.industry,phone:z.phone,needs:z.needs}),y(!0),setTimeout(()=>y(!1),3e3)}catch(a){console.error("Error updating profile",a)}finally{w(!1)}}},G=async b=>{if(E(b),!b.read&&a)try{await (0,n.updateDoc)((0,n.doc)(o.db,"messages",b.id),{read:!0})}catch(a){console.error("Failed to mark message as read",a)}};if(r||!a)return(0,b.jsx)("div",{className:p.default.container,children:"Loading..."});let H=j?.accountType==="company";return(0,b.jsxs)("div",{className:p.default.container,children:[(0,b.jsxs)("div",{className:p.default.header,children:[(0,b.jsx)("h1",{className:p.default.title,children:"Your Profile"}),(0,b.jsx)("p",{className:p.default.subtitle,children:"Manage your settings, inventory needs, and messages."})]}),(0,b.jsxs)("div",{className:p.default.content,children:[(0,b.jsxs)("div",{className:p.default.sidebar,children:[(0,b.jsxs)("button",{className:`${p.default.tabBtn} ${"details"===t?p.default.tabActive:""}`,onClick:()=>{u("details"),E(null)},children:[(0,b.jsx)(h.User,{size:18,className:p.default.tabIcon}),"Profile Details"]}),(0,b.jsxs)("button",{className:`${p.default.tabBtn} ${"messages"===t?p.default.tabActive:""}`,onClick:()=>{u("messages"),E(null)},children:[(0,b.jsx)(i.MessageSquare,{size:18,className:p.default.tabIcon}),"Messages",B.filter(a=>!a.read).length>0&&(0,b.jsx)("span",{style:{background:"#ef4444",color:"white",padding:"2px 8px",borderRadius:"12px",fontSize:"0.75rem",marginLeft:"auto"},children:B.filter(a=>!a.read).length})]})]}),(0,b.jsx)("div",{className:p.default.panel,children:(0,b.jsxs)(g.AnimatePresence,{mode:"wait",children:["details"===t&&(0,b.jsx)(f.motion.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:(0,b.jsxs)("form",{onSubmit:F,children:[(0,b.jsx)("h3",{style:{marginBottom:"1.5rem",fontSize:"1.25rem"},children:"Personal Information"}),(0,b.jsxs)("div",{className:p.default.formGrid,children:[(0,b.jsxs)("div",{className:p.default.formGroup,children:[(0,b.jsx)("label",{children:"Email Address"}),(0,b.jsx)("input",{type:"email",value:a.email||"",readOnly:!0})]}),(0,b.jsxs)("div",{className:p.default.formGroup,children:[(0,b.jsx)("label",{children:"Display Name"}),(0,b.jsx)("input",{type:"text",value:z.displayName,onChange:a=>A({...z,displayName:a.target.value})})]}),(0,b.jsxs)("div",{className:p.default.formGroup,children:[(0,b.jsx)("label",{children:"Phone Number"}),(0,b.jsx)("input",{type:"tel",value:z.phone,onChange:a=>A({...z,phone:a.target.value})})]}),H&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:p.default.formGroup,children:[(0,b.jsx)("label",{children:"Company Name"}),(0,b.jsx)("input",{type:"text",value:z.companyName,onChange:a=>A({...z,companyName:a.target.value})})]}),(0,b.jsxs)("div",{className:p.default.formGroup,children:[(0,b.jsx)("label",{children:"Industry"}),(0,b.jsx)("input",{type:"text",value:z.industry,onChange:a=>A({...z,industry:a.target.value})})]})]}),(0,b.jsxs)("div",{className:`${p.default.formGroup} ${p.default.formGroupFull}`,children:[(0,b.jsx)("label",{children:"Inventory Needs / Looking For"}),(0,b.jsx)("p",{style:{fontSize:"0.85rem",color:"rgba(255,255,255,0.5)",marginBottom:"0.5rem",marginTop:"-0.25rem"},children:"Describe the type of surplus machinery, materials, or equipment you are actively seeking."}),(0,b.jsx)("textarea",{placeholder:"e.g. We are looking for gently used packaging machinery (shrink wrappers, carton sealers) and surplus steel piping...",value:z.needs,onChange:a=>A({...z,needs:a.target.value})})]})]}),(0,b.jsxs)("div",{style:{clear:"both",overflow:"hidden"},children:[(0,b.jsx)("button",{type:"submit",className:p.default.saveBtn,disabled:v,children:v?"Saving...":"Save Changes"}),x&&(0,b.jsxs)("span",{className:p.default.successMsg,children:[(0,b.jsx)(k,{size:16})," Saved Successfully!"]})]})]})},"details"),"messages"===t&&!D&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:[(0,b.jsx)("h3",{style:{marginBottom:"1.5rem",fontSize:"1.25rem"},children:"Your Inbox"}),0===B.length?(0,b.jsxs)("div",{className:p.default.emptyState,children:[(0,b.jsx)(m,{size:48,opacity:.5,style:{margin:"0 auto",marginBottom:"1rem"}}),(0,b.jsx)("p",{children:"You have no messages yet."})]}):(0,b.jsx)("div",{className:p.default.messagesList,children:B.map(a=>(0,b.jsxs)("div",{className:`${p.default.messageItem} ${!a.read?p.default.messageUnread:""}`,onClick:()=>G(a),children:[(0,b.jsxs)("div",{className:p.default.msgHeader,children:[(0,b.jsx)("span",{className:p.default.msgSender,children:a.senderName}),(0,b.jsx)("span",{className:p.default.msgDate,children:a.createdAt?(0,q.formatDistanceToNow)(a.createdAt.toDate(),{addSuffix:!0}):""})]}),(0,b.jsx)("div",{className:p.default.msgSubject,children:a.subject}),(0,b.jsx)("div",{className:p.default.msgExcerpt,children:a.body})]},a.id))})]},"messagesList"),"messages"===t&&D&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:[(0,b.jsxs)("button",{className:p.default.backBtn,onClick:()=>E(null),children:[(0,b.jsx)(l.ArrowLeft,{size:16})," Back to Inbox"]}),(0,b.jsxs)("div",{className:p.default.msgDetailHeader,children:[(0,b.jsx)("h2",{className:p.default.msgDetailSubject,children:D.subject}),(0,b.jsxs)("div",{className:p.default.msgDetailMeta,children:[(0,b.jsxs)("span",{children:["From: ",(0,b.jsx)("strong",{style:{color:"white"},children:D.senderName})]}),(0,b.jsx)("span",{children:D.createdAt?new Date(D.createdAt.toDate()).toLocaleString():""})]})]}),(0,b.jsx)("div",{className:p.default.msgDetailBody,children:D.body})]},"messageDetail")]})})]})]})}a.s(["default",()=>r],70298)}];

//# sourceMappingURL=_6b36762d._.js.map