{"version":3,"sources":["turbopack:///[project]/src/app/onboarding/page.module.css [app-ssr] (css module)","../../../../../src/app/onboarding/page.tsx"],"sourcesContent":["__turbopack_context__.v({\n  \"card\": \"page-module__Bnw0hW__card\",\n  \"checkboxGroup\": \"page-module__Bnw0hW__checkboxGroup\",\n  \"container\": \"page-module__Bnw0hW__container\",\n  \"error\": \"page-module__Bnw0hW__error\",\n  \"form\": \"page-module__Bnw0hW__form\",\n  \"header\": \"page-module__Bnw0hW__header\",\n  \"inputGroup\": \"page-module__Bnw0hW__inputGroup\",\n  \"roleBtn\": \"page-module__Bnw0hW__roleBtn\",\n  \"roleBtnActive\": \"page-module__Bnw0hW__roleBtnActive\",\n  \"roleToggle\": \"page-module__Bnw0hW__roleToggle\",\n  \"submitBtn\": \"page-module__Bnw0hW__submitBtn\",\n  \"subtitle\": \"page-module__Bnw0hW__subtitle\",\n  \"title\": \"page-module__Bnw0hW__title\",\n});\n","\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAuth } from \"@/context/AuthContext\";\nimport { doc, updateDoc } from \"firebase/firestore\";\nimport { db } from \"@/lib/firebase\";\nimport styles from \"./page.module.css\";\nimport Ripple from \"@/components/common/Ripple\";\nimport { AlertCircle } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nexport default function OnboardingPage() {\n    const { user, userData, loading } = useAuth();\n    const router = useRouter();\n    const [role, setRole] = useState<'company' | 'individual'>('company');\n    const [isLoading, setIsLoading] = useState(false);\n    const [error, setError] = useState(\"\");\n\n    // Form Fields\n    const [companyName, setCompanyName] = useState(\"\");\n    const [industry, setIndustry] = useState(\"\");\n    const [taxId, setTaxId] = useState(\"\");\n    const [countryAddress, setCountryAddress] = useState(\"\");\n    const [phone, setPhone] = useState(\"\");\n    const [preferUsername, setPreferUsername] = useState(false);\n\n    // Shared fields\n    const [fullName, setFullName] = useState(\"\");\n    const [username, setUsername] = useState(\"\");\n\n    useEffect(() => {\n        // Redirect if already completed\n        if (!loading && userData?.profileCompleted) {\n            router.push('/');\n        }\n        // Redirect to home (which shows auth modal) if not logged in\n        if (!loading && !user) {\n            router.push('/');\n        }\n\n        // Pre-fill names if available from OAuth\n        if (user?.displayName && !fullName) {\n            setFullName(user.displayName);\n        }\n    }, [user, userData, loading, router, fullName]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(\"\");\n        setIsLoading(true);\n\n        if (!user) return;\n\n        try {\n            const userRef = doc(db, \"users\", user.uid);\n\n            const profileData: any = {\n                profileCompleted: true,\n                accountType: role,\n                phone,\n                // If they checked the box, save their username preference\n                preferUsername: role === 'company' ? preferUsername : true,\n                username: role === 'company' && !preferUsername ? null : username,\n                displayName: role === 'individual' ? fullName : (preferUsername && username ? username : companyName),\n            };\n\n            if (role === 'company') {\n                profileData.companyName = companyName;\n                profileData.industry = industry;\n                profileData.taxId = taxId;\n                profileData.countryAddress = countryAddress;\n            } else {\n                profileData.fullName = fullName;\n            }\n\n            await updateDoc(userRef, profileData);\n\n            // Force a reload or redirect to update AuthContext state\n            // Normally onAuthStateChanged listener handles some changes, but context might need manual trigger or page refresh\n            window.location.href = \"/\";\n\n        } catch (err: any) {\n            console.error(\"Error saving profile\", err);\n            setError(\"Failed to save profile. Please try again.\");\n            setIsLoading(false);\n        }\n    };\n\n    if (loading || !user || userData?.profileCompleted) {\n        return <div className={styles.container}>Loading...</div>; // Minimal loader for redirect state\n    }\n\n    return (\n        <div className={styles.container}>\n            <motion.div\n                className={styles.card}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n            >\n                <div className={styles.header}>\n                    <h1 className={styles.title}>Complete Your Profile</h1>\n                    <p className={styles.subtitle}>Tell us a bit about yourself to get started.</p>\n                </div>\n\n                {error && (\n                    <div className={styles.error}>\n                        <AlertCircle size={16} style={{ display: 'inline', marginRight: '8px', verticalAlign: 'text-bottom' }} />\n                        {error}\n                    </div>\n                )}\n\n                <div className={styles.roleToggle}>\n                    <button\n                        className={`${styles.roleBtn} ${role === 'company' ? styles.roleBtnActive : ''}`}\n                        onClick={() => setRole('company')}\n                    >\n                        Company\n                    </button>\n                    <button\n                        className={`${styles.roleBtn} ${role === 'individual' ? styles.roleBtnActive : ''}`}\n                        onClick={() => setRole('individual')}\n                    >\n                        Individual\n                    </button>\n                </div>\n\n                <form onSubmit={handleSubmit} className={styles.form}>\n                    {role === 'company' ? (\n                        <>\n                            <div className={styles.inputGroup}>\n                                <label htmlFor=\"companyName\">Company Name *</label>\n                                <input id=\"companyName\" value={companyName} onChange={e => setCompanyName(e.target.value)} required placeholder=\"Acme Corp\" />\n                            </div>\n                            <div className={styles.inputGroup}>\n                                <label htmlFor=\"industry\">Industry *</label>\n                                <input id=\"industry\" value={industry} onChange={e => setIndustry(e.target.value)} required placeholder=\"Manufacturing, Logistics, etc.\" />\n                            </div>\n                            <div className={styles.inputGroup}>\n                                <label htmlFor=\"countryAddress\">Country & Address *</label>\n                                <input id=\"countryAddress\" value={countryAddress} onChange={e => setCountryAddress(e.target.value)} required placeholder=\"Cairo, Egypt\" />\n                            </div>\n                            <div className={styles.inputGroup}>\n                                <label htmlFor=\"taxId\">Company Registration / Tax ID (Optional)</label>\n                                <input id=\"taxId\" value={taxId} onChange={e => setTaxId(e.target.value)} placeholder=\"Registration Number\" />\n                            </div>\n                            <div className={styles.inputGroup}>\n                                <label htmlFor=\"phone\">Phone Number *</label>\n                                <input id=\"phone\" type=\"tel\" value={phone} onChange={e => setPhone(e.target.value)} required placeholder=\"+20 100 000 0000\" />\n                            </div>\n\n                            <div className={styles.checkboxGroup}>\n                                <input\n                                    type=\"checkbox\"\n                                    id=\"preferUsername\"\n                                    checked={preferUsername}\n                                    onChange={e => setPreferUsername(e.target.checked)}\n                                />\n                                <label htmlFor=\"preferUsername\">Prefer to use a public Username instead of Company Name</label>\n                            </div>\n\n                            {preferUsername && (\n                                <motion.div className={styles.inputGroup} initial={{ opacity: 0, height: 0 }} animate={{ opacity: 1, height: 'auto' }}>\n                                    <label htmlFor=\"username\">Username *</label>\n                                    <input id=\"username\" value={username} onChange={e => setUsername(e.target.value)} required={preferUsername} placeholder=\"e.g. AcmeSurplus\" />\n                                </motion.div>\n                            )}\n                        </>\n                    ) : (\n                        <>\n                            <div className={styles.inputGroup}>\n                                <label htmlFor=\"fullName\">Full Name *</label>\n                                <input id=\"fullName\" value={fullName} onChange={e => setFullName(e.target.value)} required placeholder=\"John Doe\" />\n                            </div>\n                            <div className={styles.inputGroup}>\n                                <label htmlFor=\"username\">Username *</label>\n                                <input id=\"username\" value={username} onChange={e => setUsername(e.target.value)} required placeholder=\"johndoe123\" />\n                            </div>\n                            <div className={styles.inputGroup}>\n                                <label htmlFor=\"phone\">Phone Number *</label>\n                                <input id=\"phone\" type=\"tel\" value={phone} onChange={e => setPhone(e.target.value)} required placeholder=\"+20 100 000 0000\" />\n                            </div>\n                        </>\n                    )}\n\n                    <button\n                        type=\"submit\"\n                        className={styles.submitBtn}\n                        disabled={isLoading}\n                        style={{ position: 'relative', overflow: 'hidden' }}\n                    >\n                        {isLoading ? 'Saving...' : 'Complete Profile'}\n                        {!isLoading && <Ripple />}\n                    </button>\n                </form>\n            </motion.div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}